# Informe de AuditorÃ­a de Seguridad - CLIENT-ANDES
**Fecha:** 19 de enero de 2026  
**Proyecto:** CLIENT-ANDES  
**Responsable:** David Morcillo

---

## ğŸ“Š Resumen Ejecutivo

Se realizÃ³ auditorÃ­a de seguridad con `pnpm audit` encontrando **8 vulnerabilidades**:
- **2 vulnerabilidades ALTAS** (crÃ­ticas)
- **4 vulnerabilidades MODERADAS**
- **2 vulnerabilidades BAJAS**

---

## ğŸ”´ Vulnerabilidades CRÃTICAS (High)

### 1. **xlsx - Prototype Pollution**
- **Paquete:** `xlsx@0.18.5`
- **Severidad:** HIGH
- **Vulnerabilidad:** Prototype Pollution in sheetJS
- **VersiÃ³n vulnerable:** <0.19.3
- **VersiÃ³n actual:** 0.18.5
- **Estado:** âŒ **SIN PARCHE DISPONIBLE** (Patched versions: <0.0.0)
- **Advisory:** [GHSA-4r6h-8v6p-xvw6](https://github.com/advisories/GHSA-4r6h-8v6p-xvw6)
- **Impacto:** Posible ejecuciÃ³n de cÃ³digo arbitrario mediante manipulaciÃ³n de prototipos

### 2. **xlsx - Regular Expression Denial of Service (ReDoS)**
- **Paquete:** `xlsx@0.18.5`
- **Severidad:** HIGH
- **Vulnerabilidad:** ReDoS en SheetJS
- **VersiÃ³n vulnerable:** <0.20.2
- **VersiÃ³n actual:** 0.18.5
- **Estado:** âŒ **SIN PARCHE DISPONIBLE** (Patched versions: <0.0.0)
- **Advisory:** [GHSA-5pgg-2g8v-p4x9](https://github.com/advisories/GHSA-5pgg-2g8v-p4x9)
- **Impacto:** Posible denegaciÃ³n de servicio mediante expresiones regulares maliciosas

> âš ï¸ **NOTA CRÃTICA:** El paquete `xlsx` no tiene versiones parcheadas disponibles. El advisory indica "Patched versions: <0.0.0", lo que significa que **no existe soluciÃ³n dentro del mismo paquete**. Se requiere **migrar a una alternativa** como `exceljs`, `xlsx-populate` o `node-xlsx`.

---

## ğŸŸ¡ Vulnerabilidades MODERADAS

### 3. **quill - Cross-site Scripting (XSS)**
- **Paquete:** `quill` (vÃ­a `react-quill`)
- **Severidad:** MODERATE
- **VersiÃ³n vulnerable:** <=1.3.7
- **VersiÃ³n actual:** 2.0.2
- **Estado:** âœ… **ACTUALIZABLE a 2.0.4+**
- **Advisory:** [GHSA-4943-9vgg-gr5r](https://github.com/advisories/GHSA-4943-9vgg-gr5r)

### 4. **prismjs - DOM Clobbering**
- **Paquete:** `prismjs` (vÃ­a `@react-email/components`)
- **Severidad:** MODERATE
- **VersiÃ³n vulnerable:** <1.30.0
- **Estado:** âœ… **CORREGIDO** (aplicado override a >=1.30.0)
- **Advisory:** [GHSA-x7hr-w5r2-h6wg](https://github.com/advisories/GHSA-x7hr-w5r2-h6wg)

### 5. **nodemailer - Email to Unintended Domain**
- **Paquete:** `nodemailer`
- **Severidad:** MODERATE
- **VersiÃ³n vulnerable:** <7.0.7
- **VersiÃ³n actual:** 6.10.0
- **Estado:** âœ… **ACTUALIZABLE a 7.0.11+**
- **Advisory:** [GHSA-mm7p-fcc7-pg87](https://github.com/advisories/GHSA-mm7p-fcc7-pg87)

### 6. **nodemailer - DoS via Uncontrolled Recursion**
- **Paquete:** `nodemailer`
- **Severidad:** MODERATE
- **VersiÃ³n vulnerable:** <7.0.11
- **VersiÃ³n actual:** 6.10.0
- **Estado:** âœ… **ACTUALIZABLE a 7.0.11+**
- **Advisory:** [GHSA-46j5-6fg5-4gv3](https://github.com/advisories/GHSA-46j5-6fg5-4gv3)

---

## ğŸŸ¢ Vulnerabilidades BAJAS

### 7. **nodemailer - AddressParser DoS**
- **Paquete:** `nodemailer`
- **Severidad:** LOW
- **VersiÃ³n vulnerable:** <=7.0.10
- **VersiÃ³n actual:** 6.10.0
- **Estado:** âœ… **ACTUALIZABLE a 7.0.11+**
- **Advisory:** [GHSA-rcmh-qjqh-p98v](https://github.com/advisories/GHSA-rcmh-qjqh-p98v)

### 8. **quill - XSS via HTML Export**
- **Paquete:** `quill`
- **Severidad:** LOW
- **VersiÃ³n vulnerable:** =2.0.3
- **VersiÃ³n actual:** 2.0.2
- **Estado:** âœ… **ACTUALIZABLE a 2.0.4+**
- **Advisory:** [GHSA-v3m3-f69x-jf25](https://github.com/advisories/GHSA-v3m3-f69x-jf25)

---

## âœ… Correcciones AutomÃ¡ticas Aplicadas

Se ejecutÃ³ `pnpm audit --fix` y se agregaron los siguientes overrides en `package.json`:

```json
"pnpm": {
  "overrides": {
    "prismjs@<1.30.0": ">=1.30.0",
    "nodemailer@<7.0.7": ">=7.0.7",
    "nodemailer@<=7.0.10": ">=7.0.11",
    "nodemailer@<7.0.11": ">=7.0.11"
  }
}
```

---

## ğŸ“Š Estado Actual de Vulnerabilidades

| Severidad | Total | Actualizables | Sin SoluciÃ³n |
|-----------|-------|---------------|--------------|
| **High** | 2 | 0 | 2 (xlsx) |
| **Moderate** | 4 | 3 | 1 (corregida con override) |
| **Low** | 2 | 2 | 0 |
| **TOTAL** | **8** | **5** | **2 (xlsx)** |

---

## ğŸš¨ SituaciÃ³n CrÃ­tica: Paquete xlsx

### **Problema Identificado**
El paquete `xlsx@0.18.5` presenta 2 vulnerabilidades de severidad ALTA sin soluciÃ³n disponible:

1. **Prototype Pollution** (GHSA-4r6h-8v6p-xvw6)
2. **ReDoS** (GHSA-5pgg-2g8v-p4x9)

### **AnÃ¡lisis TÃ©cnico**
- El reporte de npm indica: **"Patched versions: <0.0.0"**
- No existen versiones parcheadas del paquete `xlsx` que corrijan estas vulnerabilidades
- Las versiones mÃ¡s recientes (0.20.x) tampoco resuelven el problema
- El proyecto SheetJS ha sido seÃ±alado mÃºltiples veces por problemas de seguridad sin resoluciÃ³n

### **Implicaciones**
- âš ï¸ **Riesgo de seguridad activo** en el manejo de archivos Excel
- âš ï¸ No es posible mitigar mediante actualizaciÃ³n de versiÃ³n
- âš ï¸ Requiere cambio de tecnologÃ­a para resolver

### **Alternativas Disponibles**
| Paquete | Mantenimiento | Seguridad | CaracterÃ­sticas |
|---------|---------------|-----------|-----------------|
| `exceljs` | Activo | âœ… Sin vulnerabilidades conocidas | Completo |
| `xlsx-populate` | Moderado | âœ… Sin vulnerabilidades conocidas | Medio |
| `node-xlsx` | Activo | âœ… Sin vulnerabilidades conocidas | BÃ¡sico |

> **ConclusiÃ³n:** Se requiere migraciÃ³n a biblioteca alternativa. No existe soluciÃ³n de actualizaciÃ³n para `xlsx`.

---

## ğŸ”„ Vulnerabilidades Actualizables

Las siguientes vulnerabilidades pueden resolverse mediante actualizaciÃ³n de paquetes:

### **Actualizaciones Recomendadas**
```bash
# Actualizar nodemailer (resuelve 3 vulnerabilidades)
pnpm add nodemailer@^7.0.11

# Actualizar quill (resuelve 2 vulnerabilidades)
pnpm add quill@^2.0.4
```

**Resultado esperado tras actualizaciÃ³n:**
- âœ… 5 vulnerabilidades resueltas (3 moderate + 2 low)
- âŒ 2 vulnerabilidades permanecerÃ¡n (xlsx HIGH)

---

## ğŸ“Œ ConclusiÃ³n

El proyecto CLIENT-ANDES presenta 8 vulnerabilidades de seguridad, de las cuales:

- **5 vulnerabilidades pueden resolverse** mediante actualizaciÃ³n de paquetes (`nodemailer` y `quill`)
- **1 vulnerabilidad ya fue corregida** mediante override (`prismjs`)
- **2 vulnerabilidades NO tienen soluciÃ³n** en el paquete actual (`xlsx`)

**La situaciÃ³n crÃ­tica es el paquete `xlsx`**, que requiere **cambio de tecnologÃ­a** ya que no existe versiÃ³n segura disponible.

---

**Comandos de AuditorÃ­a Utilizados:**
```bash
pnpm audit --fix
pnpm audit
```

**Resultado Final:** 8 vulnerabilidades detectadas (2 HIGH | 4 MODERATE | 2 LOW)